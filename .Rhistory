axis.title = element_text(color = "black", size = 16),
axis.text.x = element_text(color = "black", size = 16),
axis.text.y = element_text(color = "black", size = 16),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(1, 'mm'),
legend.spacing.y = unit(0.5, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(5, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
)
filename <- paste0(gsub("-", "", format(Sys.Date(),format = "%y%m%d")), "_" ,element, ".tiff")
# Append the current plot to the list
plots_list[[element]] <- current_plot
jpeg(
filename = here(figure_directory, filename),
units = "in", height = 10, width = 18, res = 600
)
print(current_plot)
dev.off()
# Append the current plot to the list
plots_list[[element]] <- current_plot
}
#Loop
plots_list <- list()
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.5, width = 0.5) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "compared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "National Commitments",
"GS" = "Global Sustainability"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
scale_x_discrete(breaks = unique(bra$Year[!is.na(bra[, paste0("diff_", element)])])) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 20, face = "bold"),
strip.text = element_text(size = 22, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 30, face = "bold"),
legend.text = element_text(family = "Arial", size = 18),
plot.title = element_text(color = "black", size = 20, face = "bold"),
axis.title = element_text(color = "black", size = 16),
axis.text.x = element_text(color = "black", size = 16),
axis.text.y = element_text(color = "black", size = 16),
legend.position = "bottom",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(1, 'mm'),
legend.spacing.y = unit(0.5, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(5, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
)
# Adjust filename for JPEG
filename <- paste0(gsub("-", "", format(Sys.Date(), format = "%y%m%d")), "_", element, ".jpeg")
# Save the plot as a JPEG
jpeg(
filename = here(figure_directory, filename),
units = "in", height = 10, width = 18, res = 600
)
print(current_plot)
dev.off()
# Append the current plot to the list
plots_list[[element]] <- current_plot
}
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = ""
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue", )
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
library(cowplot)
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
legend <- cowplot::get_legend(plots_list[[selected_elements[1]]] + theme(legend.position = "right"))
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2, rel_widths = c(0.05, 1)),
legend, ncol = 1, rel_heights = c(1, 0.3)
)
final_plot
filename <- paste0(gsub("-", "", format(Sys.Date(),format = "%y%m%d")), "_Landchange.tiff")
tiff(
filename = here(figure_directory, filename),
units = "in", height = 10, width = 16, res = 600
)
filename <- paste0(gsub("-", "", format(Sys.Date(),format = "%y%m%d")), "_MULTIPLEPLOT.tiff")
tiff(
filename = here(figure_directory, filename),
units = "in", height = 10, width = 16, res = 600
)
print(final_plot)
dev.off()
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.3)
)
final_plot
filename <- paste0(gsub("-", "", format(Sys.Date(),format = "%y%m%d")), "_MULTIPLEPLOT.tiff")
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = ""
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
legend <- cowplot::get_legend(plots_list[[selected_elements[1]]] + theme(legend.position = "right"))
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.3)
)
final_plot
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "compared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "compared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
legend <- cowplot::get_legend(plots_list[[selected_elements[1]]] + theme(legend.position = "right"))
combined_plot
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "\ncompared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
axis.title.y = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T))+
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "\ncompared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5),
axis.title.x = element_text(color = "black", size = 12),
axis.title.y = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box= "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
) +
labs(title = element_labels[element])
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
legend <- cowplot::get_legend(plots_list[[selected_elements[1]]] + theme(legend.position = "right"))
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.3)
)
combined_plot
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.3)
)
final_plot
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.5)
)
final_plot
legend
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
# MULTIPLE FIGURE ("kcal_feas", "CH4", "TotalN", "CalcWFblue")
for (element in elements) {
# Create the plot
current_plot <- bra %>%
group_by(Pathway_code) %>%
ggplot(aes(x = Year, y = !!sym(paste0("diff_", element)))) +
geom_bar(stat = "identity", data = filter(bra, !str_detect(Pathway, "complete")),
aes(fill = scenarios), colour = "white", size = 0.2) +
geom_hline(yintercept = 0, linetype = "solid") +
guides(fill = guide_legend(override.aes = list(shape = NA), nrow = 3, byrow = T)) +
geom_point(data = filter(bra, Pathway %in% c("NC_complete", "GS_complete")),
aes(y = !!sym(paste0("diff_", element)), x = Year, color = "All scenarios combined"),
size = 3, shape = 16) +
scale_color_manual(values = c("black"), name = "",
labels = c("All scenarios combined")) +
labs(
x = "",
y = paste("Difference in", units_labels[element], "\ncompared to Current Trends")
) +
facet_grid(. ~ Pathway_code, scales = "free_y",
labeller = labeller(Pathway_code = c(
"NC" = "NC",
"GS" = "GS"
))) +
scale_fill_manual(values = pathway_colors[pathway_colors != "complete"], name = "", labels = pathway_labels[pathway_labels != "complete"]) +
theme_minimal() +
theme(
text = element_text(family = "Arial", color = "black", size = 16, face = "bold"),
legend.title = element_text(family = "Arial", color = "black", size = 14, face = "bold"),
legend.text = element_text(family = "Arial", size = 13),
axis.title.x = element_text(color = "black", size = 12),
axis.title.y = element_text(color = "black", size = 12),
legend.position = "none",
legend.direction = "horizontal",
legend.box = "vertical",
legend.box.spacing = unit(0.5, 'mm'),
legend.spacing.x = unit(3, 'mm'),
legend.spacing.y = unit(3, 'mm'),
legend.box.margin = unit(0.5, "lines"),
legend.key.size = unit(5, "mm"),
panel.spacing = unit(1, "lines"),
legend.key.width = unit(8, "mm"),
legend.key.height = unit(8, "mm")
)
plots_list[[element]] <- current_plot
}
selected_elements <- c("kcal_feas", "CH4", "TotalN", "CalcWFblue")
selected_plots <- lapply(selected_elements, function(element) plots_list[[element]])
combined_plot <- plot_grid(plotlist = selected_plots, ncol = 2, align = "v")
combined_plot
legend <- cowplot::get_legend(plots_list[[selected_elements[1]]] + theme(legend.position = "right"))
# Combine the y-axis label, combined plots, and legend
final_plot <- plot_grid(
plot_grid(combined_plot, ncol = 2),
legend, ncol = 1, rel_heights = c(1, 0.5)
)
final_plot
combined_plot
final_plot
